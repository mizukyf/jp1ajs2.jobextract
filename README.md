# jp1ajs2-jobextract

JP1ユニット定義ファイルから条件にマッチするユニット定義を抽出するツール。
パーサ・ライブラリとして[jp1ajs2-unitdef](https://github.com/mizukyf/jp1ajs2.unitdef)を使用する。

## ツールの概要

コマンドラインでユニット定義の入力ソースと抽出条件を指定して実行すると、条件にマッチするユニット定義を出力される。

指定できる抽出条件は、ユニット完全名、ユニット属性パラメータ（ユニット名を含む）、ユニット定義パラメータのそれぞれの値。
複数の抽出条件を指定した場合は、すべての条件に適合したものだけが抽出対象となる。
抽出条件を指定しなかった場合は、ユニット定義ファイル上ルートレベルにあたるユニットが抜き出される。

`-s`オプションを指定した場合は標準入力からユニット定義情報を読み込む。これにより例えば`cat`コマンド（Windowsでいえば`type`コマンド）で複数の定義ファイルをまとめてパイプで`jp1ajs2-jobextract`につなげることで、複数ソースからの一括検索をすることができる。

`-f`オプションにより抽出結果の出力方法を選択できる。

## オプションの詳細

```
usage: jobextract(java -jar jp1ajs2-jobextract-...jar) [-A <attr=value>]
       [-c <input-charset>] [-C <output-charset>] [-d
       <destination-filepath>] [-f <format-name>] [-F
       <full-qualified-name>] [-i] [-N <unit-name>] [-P <param=value>]
       [-r] [-s <source-filepath>]
ユニット定義ファイルから指定された条件にマッチするユニットを抜き出す.
条件が指定されていない場合はユニット定義ファイル上ルートレベルにあたるユニットを抜き出す.
 -A <attr=value>             ユニット属性パラメータが指定された値をとる場合に抽出対象とする.
                             属性名として指定できるのは: name, ownerName,
                             permissionMode, resourceGroupName
 -c <input-charset>          ユニット定義ファイルのキャラクターセット.
                             指定しない場合はJVMのデフォルト・キャラクターセット(UTF-8)が使用される.
 -C <output-charset>         抽出結果ファイルのキャラクターセット.
                             指定しない場合はJVMのデフォルト・キャラクターセット(UTF-8)が使用される.
 -d <destination-filepath>   ユニット定義情報の抽出結果を出力するファイル.
                             指定しない場合は標準出力ファイルに出力される.
 -f <format-name>            抽出結果ファイルのフォーマット. デフォルトは"READABLE".
                             指定できるフォーマットは次の通り:
                             "LIST" - ユニット一覧フォーマット. ユニット名のみの一覧が出力される.
                             "FQN_LIST" - 完全名一覧フォーマット. ユニット完全名のみの一覧が出力される.
                             "COMPACT" - コンパクトなフォーマット. 改行やインデントは付与されない.
                             "READABLE" - 可読性の高いフォーマット. 改行とインデントが付与される.
 -F <full-qualified-name>    ユニットが指定された完全名である場合に抽出対象とする.
 -i                          抽出条件のマッチングで大文字小文字のちがいを無視する.
 -N <unit-name>              ユニットが指定された名前である場合に抽出対象とする.
                             "-Aname=..."のエイリアス.
 -P <param=value>            ユニット定義パラメータが指定された値をとる場合に抽出対象とする.
 -r                          抽出条件として指定された文字列を正規表現パターンとみなしてマッチングを行う.
 -s <source-filepath>        ユニット定義ファイルのパス.
                             絶対パスのほか"."（カレント・ディレクトリ）を起点にした相対パスも使用できる.
                             ファイルパスを指定しなかった場合は標準入力からユニット定義情報を読み取る.
```
